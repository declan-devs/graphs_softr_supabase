<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Dual Axis Plot - Bright Function</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 40px;
    }
    h2 {
      text-align: center;
    }
    #plot {
      width: 100%;
      height: 600px;
    }
  </style>
</head>
<body>
  <h2>val_1 and val_2 Over Time</h2>
  <div id="plot"></div>

  <script>
    async function loadData() {
      const response = await fetch("https://qqdcnlmlzfhugkndkrnz.supabase.co/functions/v1/bright-function");
      const data = await response.json();

      const dates = data.map(row => row.date);
      const val1 = data.map(row => row.val_1);
      const val2 = data.map(row => row.val_2);

      const trace1 = {
        x: dates,
        y: val1,
        name: 'val_1',
        type: 'scatter',
        yaxis: 'y1',
        line: { color: 'blue' }
      };

      const trace2 = {
        x: dates,
        y: val2,
        name: 'val_2',
        type: 'scatter',
        yaxis: 'y2',
        line: { color: 'orange' }
      };

      const layout = {
        title: 'Dual Axis Line Chart (val_1 vs val_2)',
        xaxis: { title: 'Date' },
        yaxis: {
          title: 'val_1',
          titlefont: { color: 'blue' },
          tickfont: { color: 'blue' }
        },
        yaxis2: {
          title: 'val_2',
          titlefont: { color: 'orange' },
          tickfont: { color: 'orange' },
          overlaying: 'y',
          side: 'right'
        },
        legend: { x: 0, y: 1.1, orientation: 'h' }
      };

      Plotly.newPlot('plot', [trace1, trace2], layout);
    }

    loadData();
  </script>
</body>
</html>
